<%= form_for(setup_registrant_choices(@registrant)) do |f| %>
  <% if @registrant.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@registrant.errors.count, "error") %> prohibited this registrant from being saved:</h2>

      <ul>
        <% @registrant.errors.each do |attribute,error_message| %>
          <% next if attribute == :gender_male %>
          <% next if attribute == :gender_female %>
          <li><%= @registrant.errors.full_message(attribute, error_message )%></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="data_block">
    <%= f.hidden_field :competitor %>
    <h2><%= @registrant.competitor ? "Competitor" : "Non-Competitor" %></h2>
    <span class="required">Required fields</span>
    <fieldset class="data_block">
      <legend>Base Details</legend>
      <span>
        <%= f.label :first_name, 'Name', :class => "required" %>
        <%= f.text_field :first_name, :placeholder => 'First', :autofocus => "true" %>
        <%= f.text_field :middle_initial, :size => 3 %>
        <%= f.text_field :last_name, :placeholder => 'Last' %>
      </span>
      <span>
        <%= f.label :birthday, :class => "required" %>
        <%= f.date_select :birthday, {:start_year => 1900, :end_year => Time.now.year, :include_blank => true, :order => [:day, :month, :year]} %>
      </span>
      <span>
        <%= f.label :gender_male, 'Male', :class => "required" %>
        <%= f.radio_button :gender, 'Male' %>
        <%= f.label :gender_female, 'Female', :class => "required" %>
        <%= f.radio_button :gender, 'Female' %>
      </span>
      <span>
        <%= f.label :club, "Primary Team or Club Name" %>
        <%= f.text_field :club %><br />
        <%= f.label :club_contact, "Primary Team or Club Contact" %>
        <%= f.text_field :club_contact %>
      </span>
      <span>
        <%= f.label :usa_member_number, "USA Membership number" %>
        <%= f.text_field :usa_member_number %><br />
      </span>
    </fieldset>
    <%= render :partial => "registration_periods/list", :locals => {:competitor => @registrant.competitor } %>

    <% unless @categories.nil? %>
      <%= render :partial => "/attending/events", :locals => {:registrant => @registrant, :categories => @categories, :f => f } %>
    <% end %>

    <div class="data_block">
      <%= render :partial => "contact_info", :locals => { :f => f } %>
    </div>

  </div>
  <div class="actions">
    <% if @registrant.competitor %>
      <%= f.submit 'Next Page (T-Shirts...)', :class => "competitor registration_button" %>
    <% else %>
      <%= f.submit 'Next Page (T-Shirts...)', :class => "noncompetitor registration_button" %>
    <% end %>
  </div>
<% end %>
