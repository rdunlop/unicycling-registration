
- if can? :admin_view, ExpenseItem
  - @groups = ExpenseGroup.admin_visible
- else
  - @groups = ExpenseGroup.visible

.new_expenses
  - @groups.includes(:expense_items).each do |expense_group|
    %fieldset.data_block
      %legend= t(".add", group_name: expense_group)
      %table
        - unless expense_group.info_url.blank?
          %tr
            %td{:colspan => "3"}
              .event_link
                = link_to t(".info") + ' [' + expense_group.to_s + ']', expense_group.info_url, { target: "_blank", class: "external_link fancybox"}
        - expense_group.expense_items.each do |ei|
          - @registrant_expense_item = RegistrantExpenseItem.new(:expense_item => ei, :registrant => @registrant)
          = render :partial => "/registrant_expense_items/new_expense", :locals => { :item => ei, :show_as_free => @registrant.expense_item_is_free(ei) }
